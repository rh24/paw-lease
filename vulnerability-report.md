# Vulnerability-Report

## Encryption
### Exposure

Encryption is critical for protecting and securing sensistive user information such as passwords and credit card information. In our application, we use ASP.NET Core Identity's hashing algorithm in order to encrypt user's passwords. This is to prevent storing passwords as plain text in the database.

Users often do not follow safe security measures, opting to reuse passwords across all their accounts. If a hacker gains access to both a user's password and e-mail, the hacker could gain access to almost every other account (financial assets, credit reports, personal & work emails) a user might have, as these days, providing two-factor authentication by e-mailing a security code is quite common. This would be truly disastrous.

### Repair

As a baseline, the entire application contains this vulnerability without ASP.NET Core Identity's encryption methods. However, a user will be jeopardized upon initial registration in `Register.cshtml`. This view contains an input field for the user to type in their password. After the user hits submit, their plain text password is carried to the `AccountController.Register()` action via a Data Transfer Object `RegisterAccount`. This object holds the plain text password but is never persisted to the database.

Within the `Register()` action in the account controller is where Identity's password hashing is called upon. If the user inputs valid fields, a new `ApplicationUser` is initialized. The `UserManager<ApplicationUser>` service provides a `CreateAsync(ApplicationUser user, string password)` method that takes care of hashing the plain text password provided by the user. This ensures that only an encrypted version will be stored in the Identity database.

```
            if (ModelState.IsValid)
            {
                CheckUserRolesExist();

                ApplicationUser newUser = new ApplicationUser()
                {
                    UserName = ra.Email,
                    FirstName = ra.FirstName,
                    LastName = ra.LastName,
                    Email = ra.Email,
                    AccountCreation = ra.AccountCreation,
                    Address = ra.Address,
                    Birthday = ra.Birthday,
                    LovesCats = ra.LovesCats
                };

                var result = await _userManager.CreateAsync(newUser, ra.Password);

				...
			}
```